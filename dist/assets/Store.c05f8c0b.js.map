{"version":3,"file":"Store.c05f8c0b.js","sources":["../../src/pages/Store.vue"],"sourcesContent":["<template>\n<div id=\"store\">\n\n</div>\n</template>\n\n<script setup>\nimport { onMounted } from 'vue';\nimport * as THREE from 'three';\nimport { MTLLoader, OBJLoader } from 'obj-mtl-loader-three';\n\nonMounted(() => {\n  /**\n  * 创建场景对象Scene\n  */\n  const scene = new THREE.Scene();\n  /**\n  * OBJ和材质文件mtl加载\n  */\n\n  const mtlLoader = new MTLLoader();\n\n  const objLoader = new OBJLoader();\n\n  mtlLoader.load('./bridge/file.mtl', (materials) => {\n    // 返回一个包含材质的对象MaterialCreator\n    materials.preload();\n    // obj的模型会和MaterialCreator包含的材质对应起来\n    console.log({ materials });\n    objLoader.setMaterials(materials);\n    objLoader.load('./bridge/file.obj', (obj) => {\n      console.log({ obj });\n      // obj.scale.set(10, 10, 10) //放大obj组对象\n      scene.add(obj);// 返回的组对象插入场景中\n    });\n  });\n\n  /**\n    * 光源设置\n    */\n  // 点光源\n  const point = new THREE.PointLight(0xffffff);\n  point.position.set(400, 200, 300); // 点光源位置\n  scene.add(point); // 点光源添加到场景中\n  // 环境光\n  const ambient = new THREE.AmbientLight(0x444444);\n  scene.add(ambient);\n  /**\n    * 相机设置\n    */\n  const width = window.innerWidth; // 窗口宽度\n  const height = window.innerHeight - 50; // 窗口高度\n  const k = width / height; // 窗口宽高比\n  const s = 200; // 三维场景显示范围控制系数，系数越大，显示的范围越大\n  // 创建相机对象\n  const camera = new THREE.OrthographicCamera(-s * k, s * k, s, -s, 1, 1000);\n  camera.position.set(100, 100, 100); // 设置相机位置\n  camera.lookAt(scene.position); // 设置相机方向(指向的场景对象)\n  /**\n    * 创建渲染器对象\n    */\n  const renderer = new THREE.WebGLRenderer();\n  renderer.setSize(width, height); // 设置渲染区域尺寸\n  renderer.setClearColor(0xb9d3ff, 1); // 设置背景颜色\n  const storeElement = document.getElementById('store');\n  if (storeElement) storeElement.appendChild(renderer.domElement);\n\n  const onWindowResize = () => {\n    renderer.setSize(window.innerWidth, window.innerHeight);\n    camera.aspect = window.innerWidth / (window.innerHeight - 50);\n    camera.updateProjectionMatrix();\n  };\n\n  window.addEventListener('resize', onWindowResize, false);\n\n  console.log('scene.children:', scene, scene.children[2]);\n\n  const keyboardControls = (function () {\n    const keys = {\n      SP: 32, W: 87, A: 65, S: 83, D: 68, UP: 38, LT: 37, DN: 40, RT: 39,\n    };\n\n    const keysPressed = {};\n\n    (function (watchedKeyCodes) {\n      const handler = function (down) {\n        return function (e) {\n          // console.log(e.keyCode)\n          const index = watchedKeyCodes.indexOf(e.keyCode);\n          if (index >= 0) {\n            keysPressed[watchedKeyCodes[index]] = down;\n            e.preventDefault();\n          }\n        };\n      };\n      window.addEventListener('keydown', handler(true), false);\n      window.addEventListener('keyup', handler(false), false);\n    }([\n      keys.SP, keys.W, keys.A, keys.S, keys.D, keys.UP, keys.LT, keys.DN, keys.RT,\n    ]));\n\n    const forward = new THREE.Vector3();\n    const sideways = new THREE.Vector3();\n    let i = 0; let\n      j = 0;\n    return function () {\n      // 观看\n      if (keysPressed[keys.UP]) {\n        i += 1;\n        camera.lookAt(new THREE.Vector3(0, 30 + i, j));\n      }\n      if (keysPressed[keys.DN]) {\n        i -= 1;\n        camera.lookAt(new THREE.Vector3(0, 30 + i, j));\n      }\n      if (keysPressed[keys.LT]) {\n        j += 10;\n        camera.lookAt(new THREE.Vector3(0, 30 + i, j));\n      }\n      if (keysPressed[keys.RT]) {\n        j -= 10;\n        camera.lookAt(new THREE.Vector3(0, 30 + i, j));\n      }\n\n      // 移动\n      if (keysPressed[keys.D]) {\n        camera.translateX(10);\n      }\n      if (keysPressed[keys.A]) {\n        camera.translateX(-10);\n      }\n\n      if (keysPressed[keys.W]) {\n        camera.translateZ(-1);\n      }\n      if (keysPressed[keys.S]) {\n        camera.translateZ(1);\n      }\n    };\n  }());\n\n  // 渲染函数\n  const render = () => {\n    keyboardControls();\n    renderer.render(scene, camera); // 执行渲染操作\n    requestAnimationFrame(render); // 请求再次执行渲染函数render，渲染下一帧\n  };\n\n  render();\n});\n</script>\n\n<style scoped>\n#store {\n  height: calc(100vh - 50px);\n}\n</style>\n"],"names":["THREE.Scene","THREE.PointLight","THREE.AmbientLight","THREE.OrthographicCamera","THREE.WebGLRenderer","THREE.Vector3"],"mappings":"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"}